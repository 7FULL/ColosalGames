<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
  </head>
  <body>
    <link rel="stylesheet" href="index.css">
    <script type="module" src="index.js"></script>
    <div id="recuadro">
        <div id="botonReset"><button id="boton"></button></div>
    
        <div class="instructions" id="instructions"></div>
        <div class="form" id="form">
        <input id="answerBox" style="flex-grow: 1;" onkeydown="if(event.keyCode===13) { document.getElementById('submitButton').click(); }">
        <input type="button" value="Enviar" id="submitButton" 
    
            onClick="google.script.run.withSuccessHandler(
            function(resultado) 
            { 
            //Imprimimos los resultados en consola siempre para que en caso de error poder ver que ha fallado
            //console.log(resultado);
    
            //Si lo que nos ha devuelto no es un json conteniendo el objeto tabla
            if(resultado.resena != null){
                document.getElementById('result').innerHTML = resultado.resena; 
                document.getElementById('personal').innerHTML = resultado.personal; 
                document.getElementById('clubResults').innerHTML = Object.values(resultado.clubes).join('');
                document.getElementById('form').style.display = 'none';
                instructions.style.display = 'none';
                botonReset.style.display = 'block';
            }else{
                document.getElementById('result').innerHTML = resultado;
                document.getElementById('clubResults').innerHTML = '';
            }
            })
            .extraerInformacion(document.getElementById('answerBox').value);" 
            
            style="flex-shrink: 0;"
        >
        </div>
        <p></p>
        <div id="result"></div>
        <p></p>
        <div id="personal"></div>
        <p></p>
        <div id="clubResults"></div>
        <p></p>
    </div>
  </body>
</html>
  
  